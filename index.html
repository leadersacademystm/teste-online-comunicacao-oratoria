<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
!function(f,b,e,v,n,t,s)
{if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};
if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];
s.parentNode.insertBefore(t,s)}(window, document,'script',
'https://connect.facebook.net/en_US/fbevents.js');
fbq('init', '1303934443348126');
fbq('track', 'PageView');
</script>
<noscript><img height="1" width="1" style="display:none"
src="https://www.facebook.com/tr?id=1303934443348126&ev=PageView&noscript=1"
/></noscript>
<title>Diagnóstico em Comunicação e Oratória</title>

<style>
/* Estilos CSS permanecem os mesmos da versão anterior */
:root { --accent-blue: #007aff; --accent-green: #28a745; --bg-page: #f5f5f7; --bg-container: #ffffff; --text-primary: #1d1d1f; --text-secondary: #6e6e73; --border-color: #d2d2d7; --border-radius-container: 16px; --border-radius-element: 10px; }
* { margin: 0; padding: 0; box-sizing: border-box; }
body { font-family: -apple-system, system-ui, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif; background-color: var(--bg-page); color: var(--text-primary); display: flex; justify-content: center; align-items: flex-start; min-height: 100vh; padding-top: 2rem; }
.container { width: 90%; max-width: 600px; background-color: var(--bg-container); border-radius: var(--border-radius-container); box-shadow: 0 8px 32px rgba(0, 0, 0, 0.08); padding: 2.5rem; margin-bottom: 2rem; }
h1, h2, h3, h4 { line-height: 1.3; }
h1 { font-size: 1.65rem; font-weight: 700; text-align: center; margin-bottom: 0.5rem; }
h2 { font-size: 1.4rem; font-weight: 600; margin-bottom: 1.5rem; min-height: 5em; }
h3 { font-size: 1.5rem; font-weight: 600; color: var(--accent-blue); margin-bottom: 0.5rem; }
h4 { font-size: 1.1rem; font-weight: 600; color: var(--text-primary); margin-top: 1.5rem; margin-bottom: 0.75rem; }
p { font-size: 1rem; color: var(--text-secondary); line-height: 1.5; margin-bottom: 1rem; }
.hidden { display: none !important; }
.logo-header { text-align: center; margin-bottom: 0.5rem; padding-bottom: 0.5rem; }
.logo-header img { max-width: 250px; height: auto; display: block; margin: 0 auto; }
.subtitle, .authority-note { text-align: center; color: var(--text-secondary); margin-bottom: 1rem; }
.subtitle { font-size: 0.95rem; margin-top: 0.5rem; line-height: 1.4; }
.authority-note { font-size: 0.85rem; color: #999; margin-top: -0.2rem; margin-bottom: 2rem; }
#progress-bar-container { width: 100%; background-color: #eef0f2; border-radius: 5px; height: 8px; margin-bottom: 2rem; overflow: hidden; }
#progress-bar { width: 0%; height: 100%; background-color: var(--accent-blue); border-radius: 5px; transition: width 0.3s ease-out; }
#question-counter { font-size: 0.9rem; font-weight: 500; color: var(--text-secondary); margin-bottom: 0.5rem; }
.answer-options { display: flex; flex-direction: column; gap: 0.75rem; }
.answer-options label { display: block; padding: 1rem; border: 1px solid var(--border-color); border-radius: var(--border-radius-element); cursor: pointer; transition: all 0.2s ease; font-weight: 500; }
.answer-options label:hover { background-color: #f9f9f9; }
.answer-options input[type="radio"] { display: none; }
.answer-options label.selected { border-color: var(--accent-blue); background-color: #f0f8ff; color: #0056b3; font-weight: 600; }
.action-btn { width: 100%; padding: 1rem; font-size: 1rem; font-weight: 600; color: #fff; background-color: var(--accent-blue); border: none; border-radius: var(--border-radius-element); cursor: pointer; margin-top: 2rem; transition: background-color 0.2s ease; }
.action-btn:disabled { background-color: #c7c7cc; cursor: not-allowed; }
.action-btn:hover:not(:disabled) { background-color: #0056b3; }
#lead-capture-section h2 { font-size: 1.5rem; font-weight: 700; text-align: center; min-height: 0; margin-bottom: 0.5rem; }
#lead-capture-section p { text-align: center; margin-bottom: 1.5rem; }
.form-group { margin-bottom: 1rem; }
.form-group label { display: block; font-weight: 500; margin-bottom: 0.5rem; }
.form-group input[type="email"] { width: 100%; padding: 0.9rem; font-size: 1rem; border: 1px solid var(--border-color); border-radius: var(--border-radius-element); }
.form-group input[type="email"]:focus { outline: none; border-color: var(--accent-blue); box-shadow: 0 0 0 2px rgba(0,122,255,0.2); }
#results-section h2 { font-size: 1.5rem; font-weight: 700; text-align: center; min-height: 0; margin-bottom: 1.5rem; }
#pillar-levels { list-style: none; padding-left: 0; margin: 1.5rem 0; column-count: 2; column-gap: 1.5rem; }
#pillar-levels li { background-color: #f9f9f9; border-left: 4px solid var(--border-color); padding: 0.8rem 1rem; margin-bottom: 0.75rem; font-size: 0.9rem; -webkit-column-break-inside: avoid; page-break-inside: avoid; break-inside: avoid; }
#pillar-levels li strong { color: var(--text-primary); font-weight: 600; } 
#pillar-levels li span { font-weight: 600; margin-left: 5px; }
#pillar-levels li span.level-baixo { color: #dc3545; } 
#pillar-levels li span.level-medio { color: #ffc107; } 
#pillar-levels li span.level-alto { color: #28a745; } 
#vac-style { margin-top: 2rem; padding: 1.5rem; background-color: #eef0f2; border-radius: var(--border-radius-element); }
#vac-style h4 { margin-top: 0; }
#vac-style strong { color: var(--accent-blue); }
#vac-style ul { list-style: disc; padding-left: 20px; font-size: 0.9rem; }
.cta-box { background-color: var(--bg-page); border-radius: 12px; padding: 2rem; text-align: center; margin-top: 2rem; }
.cta-box h3 { color: var(--text-primary); }
.cta-box p { color: var(--text-secondary); }
.price { margin: 1rem 0; }
.price .old-price { text-decoration: line-through; color: #999; font-size: 1rem; }
.price .new-price { font-size: 1.75rem; font-weight: 700; color: var(--accent-green); margin-left: 0.5rem; }
.cta-button { display: inline-block; width: 100%; padding: 1rem; background-color: var(--accent-green); color: white; text-decoration: none; font-weight: 600; border-radius: var(--border-radius-element); margin-top: 1rem; transition: background-color 0.2s; }
.cta-button:hover { background-color: #218838; }
#loading-section { text-align: center; padding: 4rem 0; }
.spinner { border: 4px solid #f3f3f3; border-top: 4px solid var(--accent-blue); border-radius: 50%; width: 40px; height: 40px; animation: spin 1s linear infinite; margin: 0 auto; }
#loading-section p { font-weight: 500; color: var(--text-secondary); margin-top: 1rem; }
@keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
@media (max-width: 600px) {
    body { padding-top: 0; }
    .container { width: 100%; margin: 0; padding: 1.5rem; border-radius: 0; box-shadow: none; min-height: 100vh; }
    h1 { font-size: 1.6rem; padding-top: 1rem; margin-bottom: 0.5rem; }
    .subtitle { font-size: 0.9rem; margin-top: 0.8rem; line-height: 1.4; margin-bottom: 0.8rem; }
    .authority-note { font-size: 0.8rem; margin-top: 0; margin-bottom: 1.5rem; } 
    h2 { font-size: 1.25rem; min-height: 6em; }
    .logo-header { padding-top: 1rem; margin-bottom: 0.5rem; padding-bottom: 0.5rem; }
    .logo-header img { max-width: 180px; }
    .answer-options label { padding: 0.9rem; }
    #pillar-levels { column-count: 1; } 
    .cta-box { padding: 1.5rem; }
}
</style>
</head>
<body>

<div class="container">
    <div class="logo-header">
        <img src="logo-leaders-academy-black.png" alt="Leader's Academy Logo">
    </div>

    <section id="quiz-section">
        <h1>Diagnóstico em Comunicação e Oratória</h1>
        <p class="subtitle">Entenda seus pontos fortes e fracos para se comunicar com mais impacto.<br>Descubra seu nível em aproximadamente 3-5 minutos.</p>
        <p class="authority-note">Já ajudamos mais de 300 pessoas a melhorarem sua comunicação e oratória.</p>
        
        <div id="progress-bar-container">
            <div id="progress-bar"></div>
        </div>
        <div id="question-counter">Pergunta 1 de 30</div>
        
        <div id="quiz-content">
            <h2>Carregando pergunta...</h2> 
            <div class="answer-options"></div>
            <button class="action-btn next-btn" disabled>Próxima</button>
        </div>
    </section>

    <section id="loading-section" class="hidden">
        <div class="spinner"></div>
        <p>Analisando suas respostas...</p>
    </section>

    <section id="lead-capture-section" class="hidden">
        <h2>Seu diagnóstico está sendo calculado!</h2>
        <p>Informe seu e-mail para receber o resultado detalhado:</p>
        
        <form id="lead-form">
            <div class="form-group">
                <label for="email">Seu melhor e-mail:</label>
                <input type="email" id="email" name="email" required placeholder="seu@email.com">
            </div>
            <button type="submit" id="submit-lead-btn" class="action-btn">Ver Meu Resultado</button>
        </form>
    </section>


    <section id="results-section" class="hidden">
        <h2>Seu Resultado Gratuito</h2>
        <h3 id="result-concept"></h3>
        <p id="result-text"></p>
        
        <h4>Níveis por Pilar:</h4>
        <ul id="pillar-levels"></ul>

        <div id="vac-style">
             <h4>Seu Estilo de Comunicação (Emissor)</h4>
             <p id="vac-text"></p>
             <ul id="vac-examples"></ul>
        </div>
        
        <hr style="margin-top: 2rem;"> 
        
        <div class="cta-box">
            <h3>Quer o Diagnóstico Completo + Plano de Ação?</h3> 
            <p>Receba o "Relatório Completo em PDF" com o diagnóstico detalhado, aprofundamento sobre seu estilo de comunicação e o **plano de ação** para TODOS os 7 pilares.</p> 
            <p class="price">
                De <span class="old-price">R$49,90</span> por apenas
                <span class="new-price">R$9,90</span>
            </p>
            
            <a href="https://pay.kiwify.com.br/SEU-LINK-AQUI" class="cta-button">
                QUERO MEU RELATÓRIO COMPLETO AGORA
            </a>
        </div>
    </section>
</div>

<script>
console.log("LOG 0: Script principal iniciado."); // LOG 0

document.addEventListener("DOMContentLoaded", () => {
    console.log("LOG A: DOMContentLoaded disparado."); // LOG A
    
    // --- 0. URL DO MAKE.COM ---
    const MAKE_WEBHOOK_URL = "https://hook.us2.make.com/ter8xjf4mb2aadw3ok68dkr4xbb8ta1a"; 
    
    
    // --- 1. CONFIGURAÇÃO DO QUIZ ---

    const concepts = {
        iniciante: { level: "Comunicador Iniciante", text: "Você tem uma base sólida, mas grandes oportunidades de melhoria. A comunicação é uma habilidade que pode ser totalmente desenvolvida, e seu primeiro passo (fazer este teste) já foi dado." },
        desenvolvimento: { level: "Comunicador em Desenvolvimento", text: "Você já demonstra diversas habilidades de comunicação, mas pode sofrer com inconsistências. O foco agora é polir suas técnicas." },
        eficaz: { level: "Comunicador Eficaz", text: "Você se comunica de forma clara e eficiente. O próximo nível é transformar sua comunicação em uma ferramenta de alta persuasão." },
        mestre: { level: "Comunicador Mestre", text: "Parabéns! Você tem um domínio avançado da comunicação e oratória. Sua habilidade de se conectar, engajar e persuadir é clara." }
    };
    // Adicionado 'questions' property
    const pillars = {
        clareza: { name: "Clareza e Objetividade", questions: 5, attention: "Sua pontuação sugere que sua <strong>Clareza</strong> pode ser um ponto de melhoria. Mensagens confusas podem diluir seu impacto." },
        postura: { name: "Linguagem Corporal e Postura", questions: 5, attention: "Observe sua <strong>Linguagem Corporal</strong>. Muitas vezes, o que seu corpo diz é mais importante do que suas palavras." },
        voz: { name: "Variedade Vocal e Dicção", questions: 4, attention: "Atenção à sua <strong>Voz e Dicção</strong>. Uma voz monótona pode fazer a melhor das mensagens parecer desinteressante." },
        vicios: { name: "Controle de Vícios de Linguagem", questions: 4, attention: "Seus resultados indicam que <strong>Vícios de Linguagem</strong> podem estar poluindo sua mensagem e tirando sua autoridade." },
        storytelling: { name: "Storytelling e Engajamento", questions: 4, attention: "Para realmente conectar, explore o <strong>Storytelling</strong>. Dados informam, mas histórias emocionam e são lembradas." },
        escuta: { name: "Escuta Ativa e Interação", questions: 4, attention: "A comunicação é uma via de mão dupla. Desenvolver sua <strong>Escuta Ativa</strong> pode ser o atalho para uma comunicação mais eficaz." },
        sintese: { name: "Poder de Síntese", questions: 4, attention: "Seu tempo (e o dos outros) é valioso. Aprimorar seu <strong>Poder de Síntese</strong> fará suas ideias serem ouvidas." }
    };
    // Perguntas com tom ajustado
    const questions = [
        { text: "Normalmente, as pessoas entendem de primeira o que você pede ou explica?", pillar: "clareza", score: [0, 1, 2, 3] },
        { text: "Você organiza seus pensamentos (início, meio, fim) antes de falar algo importante?", pillar: "clareza", score: [0, 1, 2, 3] },
        { text: "Você consegue explicar algo complexo usando palavras simples ou exemplos?", pillar: "clareza", score: [0, 1, 2, 3] },
        { text: "É comum pedirem para você repetir ou explicar de novo o que disse?", pillar: "clareza", score: [3, 2, 1, 0] },
        { text: "Você evita usar muitos termos técnicos ao falar com quem não é da sua área?", pillar: "clareza", score: [0, 1, 2, 3] },
        { text: "Você mantém contato visual com as pessoas enquanto conversa ou apresenta?", pillar: "postura", score: [0, 1, 2, 3] },
        { text: "Você gesticula com as mãos de forma natural para dar ênfase ao que fala?", pillar: "postura", score: [0, 1, 2, 3] },
        { text: "Sua postura costuma ser ereta e aberta (sem braços cruzados) quando se comunica?", pillar: "postura", score: [0, 1, 2, 3] },
        { text: "Suas expressões faciais combinam com a emoção da sua mensagem?", pillar: "postura", score: [0, 1, 2, 3] },
        { text: "Você se sente 'travado(a)' ou desconfortável com seu corpo ao falar em público?", pillar: "postura", score: [3, 2, 1, 0] },
        { text: "Você varia o tom e o volume da sua voz para tornar a fala mais interessante?", pillar: "voz", score: [0, 1, 2, 3] },
        { text: "Você fala num ritmo que é fácil para os outros acompanharem?", pillar: "voz", score: [0, 1, 2, 3] },
        { text: "As pessoas costumam dizer que sua voz é clara e fácil de ouvir?", pillar: "voz", score: [0, 1, 2, 3] },
        { text: "Você faz algum tipo de aquecimento vocal antes de apresentações importantes?", pillar: "voz", score: [0, 1, 2, 3] },
        { text: "Você percebe se usa muito 'né', 'tipo', 'ãhn', 'então...' enquanto fala?", pillar: "vicios", score: [3, 2, 1, 0] },
        { text: "Você consegue fazer pausas em silêncio para pensar, sem usar ruídos como 'hmmm'?", pillar: "vicios", score: [0, 1, 2, 3] },
        { text: "Você costuma ouvir gravações suas para identificar e corrigir vícios de linguagem?", pillar: "vicios", score: [0, 1, 2, 3] },
        { text: "Quando pego(a) de surpresa, você consegue responder sem 'engasgar' ou hesitar muito?", pillar: "vicios", score: [0, 1, 2, 3] },
        { text: "Você usa exemplos práticos ou histórias para ilustrar suas ideias?", pillar: "storytelling", score: [0, 1, 2, 3] },
        { text: "Você faz perguntas (diretas ou de reflexão) para envolver quem te escuta?", pillar: "storytelling", score: [0, 1, 2, 3] },
        { text: "Você consegue transformar dados ou informações 'secas' em algo mais interessante de ouvir?", pillar: "storytelling", score: [0, 1, 2, 3] },
        { text: "Você percebe quando as pessoas parecem 'desligar' (mexer no celular, olhar pro lado) enquanto você fala?", pillar: "storytelling", score: [3, 2, 1, 0] },
        { text: "Num debate, você espera o outro terminar de falar antes de começar a sua resposta?", pillar: "escuta", score: [0, 1, 2, 3] },
        { text: "Você demonstra que está prestando atenção (acenando, contato visual, 'uhum')?", pillar: "escuta", score: [0, 1, 2, 3] },
        { text: "Você consegue repetir com suas palavras o que o outro disse, para confirmar se entendeu certo?", pillar: "escuta", score: [0, 1, 2, 3] },
        { text: "Você responde diretamente ao que foi perguntado, sem ficar 'dando voltas'?", pillar: "escuta", score: [0, 1, 2, 3] },
        { text: "Se te pedem um resumo rápido de uma reunião longa, você consegue fazer em poucos minutos?", pillar: "sintese", score: [0, 1, 2, 3] },
        { text: "As pessoas te consideram alguém que vai 'direto ao ponto'?", pillar: "sintese", score: [0, 1, 2, 3] },
        { text: "Em e-mails ou mensagens de áudio, você costuma ser breve e objetivo(a)?", pillar: "sintese", score: [0, 1, 2, 3] },
        { text: "Você às vezes 'enrola' um pouco antes de chegar no ponto principal do que quer dizer?", pillar: "sintese", score: [3, 2, 1, 0] }
    ];
    
    // --- 2. LÓGICA DO QUIZ ---

    const quizSection = document.getElementById("quiz-section");
    const loadingSection = document.getElementById("loading-section"); 
    const leadCaptureSection = document.getElementById("lead-capture-section");
    const resultsSection = document.getElementById("results-section");
    const quizContent = document.getElementById("quiz-content");
    const progressBar = document.getElementById("progress-bar");
    const questionCounter = document.getElementById("question-counter");
    const leadForm = document.getElementById("lead-form");
    const submitLeadBtn = document.getElementById("submit-lead-btn");
    const emailInput = document.getElementById("email");

    // LOG B: Verifica se os elementos principais foram encontrados
    console.log("LOG B: Verificando elementos...");
    console.log("  quizSection:", quizSection ? "Encontrado" : "NÃO ENCONTRADO!");
    console.log("  quizContent:", quizContent ? "Encontrado" : "NÃO ENCONTRADO!");
    console.log("  progressBar:", progressBar ? "Encontrado" : "NÃO ENCONTRADO!");
    console.log("  questionCounter:", questionCounter ? "Encontrado" : "NÃO ENCONTRADO!");
    console.log("  leadForm:", leadForm ? "Encontrado" : "NÃO ENCONTRADO!");

    let currentQuestionIndex = 0;
    const pillarScores = { clareza: 0, postura: 0, voz: 0, vicios: 0, storytelling: 0, escuta: 0, sintese: 0 };
    let finalConcept = {};
    let finalPillarArray = [];
    let inferredVac = { type: 'Indefinido', text: '', examples: [] }; 
    const answerOptionsText = ["Nunca / Raramente", "Às Vezes", "Frequentemente", "Sempre / Quase Sempre"];

    function getPillarLevel(pillarId, score) {
        const pillarInfo = pillars[pillarId];
        if (!pillarInfo) return 'Indefinido';
        if (pillarInfo.questions === 5) { 
             if (score <= 6) return 'Baixo';
             if (score <= 10) return 'Médio';
             return 'Alto';
        } else if (pillarInfo.questions === 4) { 
             if (score <= 5) return 'Baixo';
             if (score <= 9) return 'Médio';
             return 'Alto';
        } else {
             return 'Indefinido';
        }
    }

    function inferVacStyle() {
        const visualScore = pillarScores.postura || 0;
        const auditoryScore = pillarScores.voz || 0;
        const kinestheticScore = pillarScores.escuta || 0; 

        const maxScore = Math.max(visualScore, auditoryScore, kinestheticScore);
        
        const vacData = {
            visual: { type: 'Visual', text: 'Sua comunicação sugere traços do estilo <strong>Visual</strong>. Pessoas com essa preferência geralmente pensam por imagens e são mais conectadas ao que veem.', examples: ['Usa expressões como "Veja bem...", "Isso parece claro?"','Gesticula bastante, como se estivesse "desenhando" no ar.','Presta atenção na aparência e na organização visual das coisas.'] },
            auditivo: { type: 'Auditivo', text: 'Sua comunicação sugere traços do estilo <strong>Auditivo</strong>. Pessoas com essa preferência processam informações ouvindo e prestando atenção às palavras e sons.', examples: ['Usa expressões como "Isso soa bem", "Ouça o que estou dizendo".','Gosta de explicações verbais detalhadas e debates.','Percebe facilmente mudanças no tom de voz das pessoas.'] },
            cinestesico: { type: 'Cinestésico', text: 'Sua comunicação sugere traços do estilo <strong>Cinestésico</strong>. Pessoas com essa preferência se conectam através de sensações, emoções e ações práticas.', examples: ['Usa expressões como "Não consegui pegar a ideia", "Vamos sentir como funciona".','Aprende melhor "colocando a mão na massa".','Valoriza o conforto e a conexão emocional nas interações.'] }
        };

        let contenders = [];
        if (visualScore === maxScore) contenders.push(vacData.visual);
        if (auditoryScore === maxScore) contenders.push(vacData.auditivo);
        if (kinestheticScore === maxScore) contenders.push(vacData.cinestesico);

        if (contenders.length === 1) {
            inferredVac = contenders[0];
        } else if (contenders.length > 1) {
             inferredVac.type = contenders.map(c => c.type).join(' / ');
             inferredVac.text = `Sua comunicação parece combinar traços dos estilos <strong>${inferredVac.type}</strong>. Você pode se adaptar bem a diferentes formas de interação.`;
             inferredVac.examples = []; 
        } else {
             inferredVac.type = 'Misto/Indefinido';
             inferredVac.text = 'Seu estilo de comunicação parece ser uma combinação equilibrada ou não foi possível determinar uma única predominância com base neste teste.';
             inferredVac.examples = [];
        }
    }


    function renderQuestion(index) {
        console.log("LOG 1: Entrando em renderQuestion para índice:", index); // LOG 1

        if (index >= questions.length) {
            console.log("LOG 2: Índice fora dos limites, calculando resultados..."); // LOG 2
            calculateFinalResults(); 
            showLoadingScreen();     
            return;
        }

        if (!quizContent || !progressBar || !questionCounter) {
             console.error("ERRO FATAL: Elemento(s) essencial(is) do quiz não encontrado(s). Verifique os IDs no HTML.");
             return; 
        }

        const question = questions[index];
        if (!question || !question.score) { 
             console.error("ERRO: Objeto 'question' inválido ou sem 'score' para o índice:", index, question); 
             return; 
        }
        console.log("LOG 3: Pergunta carregada:", question.text); // LOG 3
        const progressPercentage = ((index) / questions.length) * 100;

        progressBar.style.width = `${progressPercentage}%`;
        questionCounter.textContent = `Pergunta ${index + 1} de ${questions.length}`;

        quizContent.innerHTML = ''; 
        console.log("LOG 4: quizContent limpo."); // LOG 4

        const questionTitle = document.createElement('h2');
        questionTitle.textContent = question.text;
        quizContent.appendChild(questionTitle);
        console.log("LOG 5: Título H2 adicionado."); // LOG 5

        const optionsDiv = document.createElement('div');
        optionsDiv.className = 'answer-options';
        console.log("LOG 6: Div de opções criada."); // LOG 6

        answerOptionsText.forEach((text, i) => {
             console.log("LOG 7: Criando opção:", i, text); // LOG 7 (dentro do loop)
             if (question.score && typeof question.score[i] !== 'undefined') { 
                 const label = document.createElement('label');
                 const radio = document.createElement('input');
                 radio.type = 'radio'; radio.name = `q${index}`; radio.value = question.score[i];
                 const span = document.createElement('span');
                 span.textContent = ` ${text}`;
                 label.appendChild(radio); label.appendChild(span); optionsDiv.appendChild(label);
             } else {
                 console.error("ERRO: Score indefinido para opção", i, " na pergunta:", index, question);
             }
        });
        
        quizContent.appendChild(optionsDiv);
        console.log("LOG 8: Div de opções adicionada ao quizContent."); // LOG 8

        const nextBtn = document.createElement('button');
        nextBtn.className = 'action-btn next-btn'; nextBtn.textContent = 'Próxima'; nextBtn.disabled = true;
        quizContent.appendChild(nextBtn);
        console.log("LOG 9: Botão 'Próxima' adicionado."); // LOG 9

        console.log("LOG 10: Adicionando event listeners..."); // LOG 10
        const labels = quizContent.querySelectorAll(".answer-options label");
        labels.forEach(label => {
            label.addEventListener("click", () => {
                labels.forEach(l => l.classList.remove("selected"));
                label.classList.add("selected");
                if (nextBtn) { 
                    nextBtn.disabled = false;
                } else {
                    console.error("ERRO: Botão 'Próxima' não encontrado ao tentar habilitar.");
                }
            });
        });

        if (nextBtn) { 
            nextBtn.addEventListener("click", () => {
                const selectedRadio = quizContent.querySelector(`input[name="q${index}"]:checked`);
                if (selectedRadio) {
                    const score = parseInt(selectedRadio.value);
                    if (question.pillar && typeof pillarScores[question.pillar] !== 'undefined') {
                        pillarScores[question.pillar] += score;
                    } else {
                        console.error("ERRO: Pilar inválido ou não encontrado na pergunta:", index, question);
                    }
                    currentQuestionIndex++;
                    renderQuestion(currentQuestionIndex);
                }
            });
        } else {
             console.error("ERRO: Botão 'Próxima' não encontrado para adicionar listener de clique.");
        }
        console.log("LOG 11: renderQuestion concluída para índice:", index); // LOG 11
    }

    function calculateFinalResults() {
        console.log("LOG C: Calculando resultados finais...");
        let totalScore = 0;
        for (const pillar in pillarScores) { totalScore += pillarScores[pillar]; }

        if (totalScore <= 30) { finalConcept = concepts.iniciante; } 
        else if (totalScore <= 60) { finalConcept = concepts.desenvolvimento; } 
        else if (totalScore <= 80) { finalConcept = concepts.eficaz; } 
        else { finalConcept = concepts.mestre; }
        finalConcept.totalScore = totalScore; 

        finalPillarArray = Object.keys(pillarScores).map(key => ({
            id: key, 
            score: pillarScores[key], 
            level: getPillarLevel(key, pillarScores[key]), 
            attentionText: pillars[key] ? pillars[key].attention : ''
        }));
        finalPillarArray.sort((a, b) => a.score - b.score);
        console.log("LOG D: Resultados calculados:", finalConcept, finalPillarArray);
        inferVacStyle(); // Chama inferVacStyle aqui
        console.log("LOG D.1: Estilo VAC inferido:", inferredVac);
    }

    function showLoadingScreen() {
        console.log("LOG E: Mostrando tela de loading...");
        if (quizSection) quizSection.classList.add("hidden");
        if (loadingSection) loadingSection.classList.remove("hidden"); 

        setTimeout(() => {
            console.log("LOG F: Escondendo loading, mostrando captura de lead...");
            if (loadingSection) loadingSection.classList.add("hidden"); 
            showLeadCapture(); 
        }, 3000); 
    }

    function showLeadCapture() {
        console.log("LOG F.1: Mostrando captura de lead...");
        if (leadCaptureSection) leadCaptureSection.classList.remove("hidden");
        else console.error("ERRO: Seção de captura de lead não encontrada!");
    }
    
    leadForm.addEventListener("submit", async (e) => {
        e.preventDefault(); 
        console.log("LOG G: Formulário de lead enviado.");
        if (submitLeadBtn) {
            submitLeadBtn.disabled = true; submitLeadBtn.textContent = "Enviando...";
        }
        const email = emailInput ? emailInput.value : null;
        if (!email) {
            console.error("ERRO: Campo de e-mail não encontrado ou vazio.");
            if (submitLeadBtn) { 
                 submitLeadBtn.disabled = false; submitLeadBtn.textContent = "Ver Meu Resultado";
            }
            return; 
        }
        const dataToSend = { "e-mail": email, "conceito": finalConcept.level, "scoreTotal": finalConcept.totalScore, "scoreClareza": pillarScores.clareza, "scorePostura": pillarScores.postura, "scoreVoz": pillarScores.voz, "scoreVicios": pillarScores.vicios, "scoreStorytelling": pillarScores.storytelling, "scoreEscuta": pillarScores.escuta, "scoreSintese": pillarScores.sintese };

        try {
             console.log("LOG H: Tentando disparar Pixel Lead (SIMPLES)..."); 
             if (typeof fbq === 'function') {
                 fbq('track', 'Lead'); 
                 console.log("LOG I: Pixel Lead (SIMPLES) disparado (ou tentado)."); 
             } else {
                 console.log("LOG J: Função fbq não encontrada."); 
             }

            console.log("LOG K: Tentando enviar para Make.com..."); 
            await fetch(MAKE_WEBHOOK_URL, { 
                method: 'POST', 
                headers: {'Content-Type': 'application/json'}, 
                body: JSON.stringify(dataToSend) 
            });
            console.log("LOG L: Envio para Make.com concluído (sem erros no fetch)."); 
            
            showResultsPage();

        } catch (error) {
            console.error("ERRO M: Erro durante o envio (Make ou Pixel):", error);
            showResultsPage(); 
        }
    });

    function showResultsPage() {
        console.log("LOG N: Mostrando página de resultados...");
        if (leadCaptureSection) leadCaptureSection.classList.add("hidden");
        if (resultsSection) resultsSection.classList.remove("hidden");
        else {
             console.error("ERRO: Seção de resultados não encontrada!");
             return;
        }

        const resultConceptEl = document.getElementById("result-concept");
        const resultTextEl = document.getElementById("result-text");
        const pillarListEl = document.getElementById("pillar-levels"); 
        const vacTextEl = document.getElementById("vac-text");         
        const vacExamplesEl = document.getElementById("vac-examples"); 

        if (resultConceptEl && resultTextEl && pillarListEl && vacTextEl && vacExamplesEl && finalPillarArray.length === 7) {
            resultConceptEl.textContent = finalConcept.level || 'N/A';
            resultTextEl.textContent = finalConcept.text || 'N/A';

            pillarListEl.innerHTML = ''; 
            const sortedPillarsForDisplay = [...finalPillarArray].sort((a, b) => pillars[a.id].name.localeCompare(pillars[b.id].name)); 
            
            sortedPillarsForDisplay.forEach(pillar => {
                 const li = document.createElement('li');
                 const levelClass = `level-${pillar.level?.toLowerCase() || 'indefinido'}`; 
                 li.innerHTML = `<strong>${pillars[pillar.id]?.name || pillar.id}:</strong> <span class="${levelClass}">${pillar.level || 'N/A'}</span>`;
                 pillarListEl.appendChild(li);
            });

            vacTextEl.innerHTML = inferredVac.text || 'Não foi possível determinar seu estilo predominante.';
            vacExamplesEl.innerHTML = ''; 
            if (inferredVac.examples && inferredVac.examples.length > 0) {
                 inferredVac.examples.forEach(example => {
                      const li = document.createElement('li');
                      li.textContent = example;
                      vacExamplesEl.appendChild(li);
                 });
            }
             console.log("LOG O: Página de resultados preenchida.");

        } else {
             console.error("ERRO: Elemento(s) da página de resultados não encontrado(s) ou dados insuficientes.");
             if(pillarListEl) pillarListEl.innerHTML = '<li>Erro ao carregar os níveis dos pilares.</li>'; 
             if(vacTextEl) vacTextEl.innerHTML = 'Erro ao carregar seu estilo de comunicação.';
        }
    }

    try {
        console.log("LOG P: Chamando renderQuestion(0) pela primeira vez.");
        if (questions && questions.length > 0) {
           renderQuestion(currentQuestionIndex);
        } else {
           console.error("ERRO FATAL: Array 'questions' está vazio ou indefinido.");
            if(quizContent) {
                quizContent.innerHTML = '<h2>Ocorreu um erro ao carregar as perguntas. Tente recarregar a página.</h2>';
            }
        }
    } catch (error) {
        console.error("ERRO FATAL Q: Erro ao iniciar o quiz:", error);
        if(quizContent) {
            quizContent.innerHTML = '<h2>Ocorreu um erro ao carregar o quiz. Tente recarregar a página.</h2>';
        }
    }
});
console.log("LOG Z: Script principal finalizado."); // LOG Z
</script>

</body>
</html>
