<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teste de Proficiência em Comunicação</title>

    <style>
        /* --- 1. Reset e Estilos Globais (Estética Apple/macOS) --- */
        :root {
            --accent-blue: #007aff;
            --accent-green: #28a745;
            --bg-page: #f5f5f7;
            --bg-container: #ffffff;
            --text-primary: #1d1d1f;
            --text-secondary: #6e6e73;
            --border-color: #d2d2d7;
            --border-radius-container: 16px;
            --border-radius-element: 10px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, system-ui, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background-color: var(--bg-page);
            color: var(--text-primary);
            display: flex;
            justify-content: center;
            align-items: flex-start;
            min-height: 100vh;
            padding-top: 2rem;
        }

        .container {
            width: 90%;
            max-width: 600px;
            background-color: var(--bg-container);
            border-radius: var(--border-radius-container);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.08);
            padding: 2.5rem;
            margin-bottom: 2rem;
        }

        h1, h2, h3, h4 {
            line-height: 1.3;
        }

        h1 {
            font-size: 1.75rem;
            font-weight: 700;
            text-align: center;
            margin-bottom: 1.5rem;
        }

        h2 { /* Pergunta do Quiz */
            font-size: 1.4rem;
            font-weight: 600;
            margin-bottom: 1.5rem;
            min-height: 5em; /* Garante altura mínima para não "pular" */
        }

        h3 { /* Conceito do Resultado */
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--accent-blue);
            margin-bottom: 0.5rem;
        }

        p {
            font-size: 1rem;
            color: var(--text-secondary);
            line-height: 1.5;
            margin-bottom: 1rem;
        }

        .hidden {
            display: none !important;
        }

        /* --- 2. Estilos do Quiz --- */
        #progress-bar-container {
            width: 100%;
            background-color: #eef0f2;
            border-radius: 5px;
            height: 8px;
            margin-bottom: 2rem;
            overflow: hidden;
        }

        #progress-bar {
            width: 0%;
            height: 100%;
            background-color: var(--accent-blue);
            border-radius: 5px;
            transition: width 0.3s ease-out;
        }

        #question-counter {
            font-size: 0.9rem;
            font-weight: 500;
            color: var(--text-secondary);
            margin-bottom: 0.5rem;
        }

        .answer-options {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }

        .answer-options label {
            display: block;
            padding: 1rem;
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius-element);
            cursor: pointer;
            transition: all 0.2s ease;
            font-weight: 500;
        }

        .answer-options label:hover {
            background-color: #f9f9f9;
        }

        .answer-options input[type="radio"] {
            display: none;
        }

        .answer-options label.selected {
            border-color: var(--accent-blue);
            background-color: #f0f8ff;
            color: #0056b3;
            font-weight: 600;
        }

        .action-btn { /* Classe genérica para botões */
            width: 100%;
            padding: 1rem;
            font-size: 1rem;
            font-weight: 600;
            color: #fff;
            background-color: var(--accent-blue);
            border: none;
            border-radius: var(--border-radius-element);
            cursor: pointer;
            margin-top: 2rem;
            transition: background-color 0.2s ease;
        }

        .action-btn:disabled {
            background-color: #c7c7cc;
            cursor: not-allowed;
        }

        .action-btn:hover:not(:disabled) {
            background-color: #0056b3;
        }
        
        /* --- 3. Estilos da Captura de Lead --- */
        #lead-capture-section h2 {
             font-size: 1.5rem;
            font-weight: 700;
            text-align: center;
            min-height: 0;
            margin-bottom: 0.5rem;
        }
         #lead-capture-section p {
            text-align: center;
            margin-bottom: 1.5rem;
         }
        
        .form-group {
            margin-bottom: 1rem;
        }
        
        .form-group label {
            display: block;
            font-weight: 500;
            margin-bottom: 0.5rem;
        }
        
        .form-group input[type="email"] {
            width: 100%;
            padding: 0.9rem;
            font-size: 1rem;
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius-element);
        }
        .form-group input[type="email"]:focus {
            outline: none;
            border-color: var(--accent-blue);
            box-shadow: 0 0 0 2px rgba(0,122,255,0.2);
        }


        /* --- 4. Estilos da Seção de Resultados --- */
        #results-section h2 {
            font-size: 1.5rem;
            font-weight: 700;
            text-align: center;
            min-height: 0;
            margin-bottom: 1.5rem;
        }

        #attention-points {
            list-style: none;
            margin: 1.5rem 0;
        }

        #attention-points li {
            background-color: #fff8e1;
            border-left: 4px solid #ffc107;
            padding: 1rem;
            margin-bottom: 0.75rem;
            font-weight: 500;
            color: #665200;
        }

        .cta-box {
            background-color: var(--bg-page);
            border-radius: 12px;
            padding: 2rem;
            text-align: center;
            margin-top: 2rem;
        }
        
        .cta-box h3 {
            color: var(--text-primary);
        }

        .cta-box p {
            color: var(--text-secondary);
        }

        .price {
            margin: 1rem 0;
        }

        .price .old-price {
            text-decoration: line-through;
            color: #999;
            font-size: 1rem;
        }

        .price .new-price {
            font-size: 1.75rem;
            font-weight: 700;
            color: var(--accent-green);
            margin-left: 0.5rem;
        }

        .cta-button {
            display: inline-block;
            width: 100%;
            padding: 1rem;
            background-color: var(--accent-green);
            color: white;
            text-decoration: none;
            font-weight: 600;
            border-radius: var(--border-radius-element);
            margin-top: 1rem;
            transition: background-color 0.2s;
        }

        .cta-button:hover {
            background-color: #218838;
        }

        /* --- 5. Media Query para Responsividade (iPhones) --- */
        @media (max-width: 600px) {
            body {
                padding-top: 0;
            }
            
            .container {
                width: 100%;
                margin: 0;
                padding: 1.5rem;
                border-radius: 0;
                box-shadow: none;
                min-height: 100vh;
            }

            h1 {
                font-size: 1.5rem;
                padding-top: 1rem;
            }

            h2 { /* Pergunta do Quiz */
                font-size: 1.25rem;
                min-height: 6em;
            }

            .answer-options label {
                padding: 0.9rem;
            }

            .cta-box {
                padding: 1.5rem;
            }
        }
    </style>
</head>
<body>

    <div class="container">

        <section id="quiz-section">
            <h1>Teste de Proficiência em Comunicação</h1>
            <div id="progress-bar-container">
                <div id="progress-bar"></div>
            </div>
            <div id="question-counter">Pergunta 1 de 30</div>
            
            <div id="quiz-content">
                <h2>Carregando pergunta...</h2>
                <div class="answer-options"></div>
                <button class="action-btn next-btn" disabled>Próxima</button>
            </div>
        </section>

        <section id="lead-capture-section" class="hidden">
            <h2>Quase lá!</h2>
            <p>Seus resultados estão prontos. Onde devemos enviá-los?</p>
            
            <form id="lead-form">
                <div class="form-group">
                    <label for="email">Seu melhor e-mail:</label>
                    <input type="email" id="email" name="email" required placeholder="seu@email.com">
                </div>
                <button type="submit" id="submit-lead-btn" class="action-btn">Ver Meu Resultado</button>
            </form>
        </section>


        <section id="results-section" class="hidden">
            <h2>Seu Resultado Gratuito</h2>
            <h3 id="result-concept"></h3>
            <p id="result-text"></p>
            
            <h4>Pontos de Atenção (Pilares com menor pontuação):</h4>
            <ul id="attention-points">
                </ul>
            
            <hr>
            
            <div class="cta-box">
                <h3>Quer o Diagnóstico Completo?</h3>
                <p>Receba o "Relatório Completo em PDF" com o diagnóstico detalhado para TODOS os 7 pilares, entendendo exatamente *o que* precisa ser melhorado.</p>
                <p class="price">
                    De <span class="old-price">R$49,90</span> por apenas
                    <span class="new-price">R$9,90</span>
                </p>
                
                <a href="https://pay.kiwify.com.br/SEU-LINK-AQUI" class="cta-button">
                    QUERO MEU RELATÓRIO COMPLETO AGORA
                </a>
            </div>
        </section>
    </div>

    <script>
        document.addEventListener("DOMContentLoaded", () => {
            
            // --- 0. URL DO MAKE.COM ---
            // !! IMPORTANTE !! Cole aqui a URL do Webhook que o Make.com lhe deu
            const MAKE_WEBHOOK_URL = "https://hook.us1.make.com/SEU-CODIGO-AQUI"; 
            
            
            // --- 1. CONFIGURAÇÃO DO QUIZ ---

            const concepts = {
                iniciante: { level: "Comunicador Iniciante", text: "Você tem uma base sólida, mas grandes oportunidades de melhoria..." },
                desenvolvimento: { level: "Comunicador em Desenvolvimento", text: "Você já demonstra diversas habilidades de comunicação, mas pode sofrer com inconsistências..." },
                eficaz: { level: "Comunicador Eficaz", text: "Você se comunica de forma clara e eficiente. O próximo nível é a persuasão." },
                mestre: { level: "Comunicador Mestre", text: "Parabéns! Você tem um domínio avançado da comunicação e oratória." }
            };

            const pillars = {
                clareza: { name: "Clareza e Objetividade", attention: "Sua pontuação sugere que sua <strong>Clareza</strong> pode ser um ponto de melhoria." },
                postura: { name: "Linguagem Corporal e Postura", attention: "Observe sua <strong>Linguagem Corporal</strong>. Muitas vezes, o que seu corpo diz é mais importante." },
                voz: { name: "Variedade Vocal e Dicção", attention: "Atenção à sua <strong>Voz e Dicção</strong>. Uma voz monótona pode ser desinteressante." },
                vicios: { name: "Controle de Vícios de Linguagem", attention: "Seus resultados indicam que <strong>Vícios de Linguagem</strong> podem estar poluindo sua mensagem." },
                storytelling: { name: "Storytelling e Engajamento", attention: "Para realmente conectar, explore o <strong>Storytelling</strong>." },
                escuta: { name: "Escuta Ativa e Interação", attention: "A comunicação é uma via de mão dupla. Desenvolva sua <strong>Escuta Ativa</strong>." },
                sintese: { name: "Poder de Síntese", attention: "Seu tempo é valioso. Aprimore seu <strong>Poder de Síntese</strong>." }
            };

            const questions = [
                // Pilar 1: Clareza (5Q)
                { text: "As pessoas costumam entender minhas instruções de primeira?", pillar: "clareza", score: [0, 1, 2, 3] },
                { text: "Eu organizo meus pensamentos (início, meio e fim) antes de falar algo importante?", pillar: "clareza", score: [0, 1, 2, 3] },
                { text: "Eu consigo explicar um conceito complexo usando termos simples?", pillar: "clareza", score: [0, 1, 2, 3] },
                { text: "As pessoas pedem para eu repetir o que eu disse?", pillar: "clareza", score: [3, 2, 1, 0] }, // Reversa
                { text: "Eu evito jargões técnicos ao falar com quem não é da minha área?", pillar: "clareza", score: [0, 1, 2, 3] },
                // Pilar 2: Postura (5Q)
                { text: "Eu mantenho contato visual com minha audiência?", pillar: "postura", score: [0, 1, 2, 3] },
                { text: "Eu gesticulo com as mãos de forma natural para enfatizar minhas palavras?", pillar: "postura", score: [0, 1, 2, 3] },
                { text: "Minha postura é ereta e aberta (evitando braços cruzados)?", pillar: "postura", score: [0, 1, 2, 3] },
                { text: "Minhas expressões faciais correspondem à emoção da minha mensagem?", pillar: "postura", score: [0, 1, 2, 3] },
                { text: "Eu me sinto 'travado' com meu corpo ao falar em público?", pillar: "postura", score: [3, 2, 1, 0] }, // Reversa
                // Pilar 3: Voz (4Q)
                { text: "Eu altero o tom e o volume da minha voz para evitar monotonia?", pillar: "voz", score: [0, 1, 2, 3] },
                { text: "Eu falo em um ritmo (velocidade) que é fácil de acompanhar?", pillar: "voz", score: [0, 1, 2, 3] },
                { text: "As pessoas comentam que minha voz é clara e fácil de ouvir?", pillar: "voz", score: [0, 1, 2, 3] },
                { text: "Eu pratico exercícios de aquecimento vocal antes de apresentações?", pillar: "voz", score: [0, 1, 2, 3] },
                // Pilar 4: Vícios (4Q)
                { text: "Eu me pego usando 'né', 'tipo', 'ãhn', 'então...' repetidamente?", pillar: "vicios", score: [3, 2, 1, 0] }, // Reversa
                { text: "Eu consigo fazer pausas em silêncio (sem preenchê-las com ruídos)?", pillar: "vicios", score: [0, 1, 2, 3] },
                { text: "Eu reviso gravações minhas para identificar e reduzir vícios?", pillar: "vicios", score: [0, 1, 2, 3] },
                { text: "Ao ser pego de surpresa, consigo responder sem 'engasgar'?", pillar: "vicios", score: [0, 1, 2, 3] },
                // Pilar 5: Storytelling (4Q)
                { text: "Eu uso exemplos práticos ou histórias pessoais para ilustrar meus pontos?", pillar: "storytelling", score: [0, 1, 2, 3] },
                { text: "Eu faço perguntas retóricas ou diretas para envolver quem me ouve?", pillar: "storytelling", score: [0, 1, 2, 3] },
                { text: "Eu consigo transformar dados 'chatos' em uma narrativa interessante?", pillar: "storytelling", score: [0, 1, 2, 3] },
                { text: "Eu percebo que as pessoas 'desconectam' quando eu falo por muito tempo?", pillar: "storytelling", score: [3, 2, 1, 0] }, // Reversa
                // Pilar 6: Escuta (4Q)
                { text: "Eu espero a outra pessoa concluir o raciocínio antes de formular minha resposta?", pillar: "escuta", score: [0, 1, 2, 3] },
                { text: "Eu demonstro que estou ouvindo (acenando com a cabeça, etc)?", pillar: "escuta", score: [0, 1, 2, 3] },
                { text: "Eu consigo parafrasear o que a outra pessoa disse para confirmar meu entendimento?", pillar: "escuta", score: [0, 1, 2, 3] },
                { text: "Eu respondo exatamente ao que foi perguntado, sem 'dar voltas'?", pillar: "escuta", score: [0, 1, 2, 3] },
                // Pilar 7: Síntese (4Q)
                { text: "Se me pedem para resumir uma reunião de 1 hora, consigo fazê-lo em 2 minutos?", pillar: "sintese", score: [0, 1, 2, 3] },
                { text: "Eu sou conhecido por ir 'direto ao ponto'?", pillar: "sintese", score: [0, 1, 2, 3] },
                { text: "Em e-mails ou mensagens de áudio, sou breve e objetivo?", pillar: "sintese", score: [0, 1, 2, 3] },
                { text: "Eu 'enrolo' para chegar na conclusão principal?", pillar: "sintese", score: [3, 2, 1, 0] } // Reversa
            ];
            
            // --- 2. LÓGICA DO QUIZ ---

            const quizSection = document.getElementById("quiz-section");
            const leadCaptureSection = document.getElementById("lead-capture-section");
            const resultsSection = document.getElementById("results-section");
            
            const quizContent = document.getElementById("quiz-content");
            const progressBar = document.getElementById("progress-bar");
            const questionCounter = document.getElementById("question-counter");
            
            const leadForm = document.getElementById("lead-form");
            const submitLeadBtn = document.getElementById("submit-lead-btn");
            const emailInput = document.getElementById("email");

            let currentQuestionIndex = 0;
            const pillarScores = {
                clareza: 0, postura: 0, voz: 0, vicios: 0, storytelling: 0, escuta: 0, sintese: 0
            };
            
            // Variáveis para guardar o resultado final
            let finalConcept = {};
            let finalPillarArray = [];

            function renderQuestion(index) {
                if (index >= questions.length) {
                    // *** MUDANÇA PRINCIPAL: Em vez de mostrar o resultado, mostra a captura de lead ***
                    calculateFinalResults(); // Calcula e armazena os resultados
                    showLeadCapture();       // Mostra o formulário de email
                    return;
                }

                const question = questions[index];
                const progressPercentage = ((index) / questions.length) * 100;

                progressBar.style.width = `${progressPercentage}%`;
                questionCounter.textContent = `Pergunta ${index + 1} de ${questions.length}`;

                quizContent.innerHTML = `
                    <h2>${question.text}</h2>
                    <div class="answer-options">
                        <label>
                            <input type="radio" name="q${index}" value="${question.score[0]}"> <span>Nunca / Raramente</span>
                        </label>
                        <label>
                            <input type="radio" name="q${index}" value="${question.score[1]}"> <span>Às Vezes</span>
                        </label>
                        <label>
                            <input type="radio" name="q${index}" value="${question.score[2]}"> <span>Frequentemente</span>
                        </label>
                        <label>
                            <input type="radio" name="q${index}" value="${question.score[3]}"> <span>Sempre / Quase Sempre</span>
                        </label>
                    </div>
                    <button class="action-btn next-btn" disabled>Próxima</button>
                `;

                const labels = quizContent.querySelectorAll(".answer-options label");
                const nextBtn = quizContent.querySelector(".next-btn");

                labels.forEach(label => {
                    label.addEventListener("click", () => {
                        labels.forEach(l => l.classList.remove("selected"));
                        label.classList.add("selected");
                        nextBtn.disabled = false;
                    });
                });

                nextBtn.addEventListener("click", () => {
                    const selectedRadio = quizContent.querySelector(`input[name="q${index}"]:checked`);
                    if (selectedRadio) {
                        const score = parseInt(selectedRadio.value);
                        const pillar = question.pillar;
                        pillarScores[pillar] += score;
                        currentQuestionIndex++;
                        renderQuestion(currentQuestionIndex);
                    }
                });
            }

            // (NOVA FUNÇÃO) Calcula os resultados e armazena em variáveis globais
            function calculateFinalResults() {
                let totalScore = 0;
                for (const pillar in pillarScores) {
                    totalScore += pillarScores[pillar];
                }

                if (totalScore <= 30) {
                    finalConcept = concepts.iniciante;
                } else if (totalScore <= 60) {
                    finalConcept = concepts.desenvolvimento;
                } else if (totalScore <= 80) {
                    finalConcept = concepts.eficaz;
                } else {
                    finalConcept = concepts.mestre;
                }
                finalConcept.totalScore = totalScore; // Armazena a pontuação total

                finalPillarArray = Object.keys(pillarScores).map(key => {
                    return {
                        id: key,
                        score: pillarScores[key],
                        attentionText: pillars[key].attention
                    };
                });
                
                finalPillarArray.sort((a, b) => a.score - b.score);
            }

            // (NOVA FUNÇÃO) Mostra a seção de captura de leads
            function showLeadCapture() {
                quizSection.classList.add("hidden");
                leadCaptureSection.classList.remove("hidden");
            }
            
            // (NOVA FUNÇÃO) Lida com o envio do formulário de lead
            leadForm.addEventListener("submit", async (e) => {
                e.preventDefault(); // Impede o recarregamento da página
                submitLeadBtn.disabled = true;
                submitLeadBtn.textContent = "Enviando...";

                const email = emailInput.value;

                // 1. Monta o pacote de dados para o Make.com
                const dataToSend = {
                    "e-mail": email,
                    "conceito": finalConcept.level,
                    "scoreTotal": finalConcept.totalScore,
                    "scoreClareza": pillarScores.clareza,
                    "scorePostura": pillarScores.postura,
                    "scoreVoz": pillarScores.voz,
                    "scoreVicios": pillarScores.vicios,
                    "scoreStorytelling": pillarScores.storytelling,
                    "scoreEscuta": pillarScores.escuta,
                    "scoreSintese": pillarScores.sintese
                };

                try {
                    // 2. Envia os dados para o Webhook
                    await fetch(MAKE_WEBHOOK_URL, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify(dataToSend)
                    });
                    
                    // 3. Se deu certo (ou mesmo se não deu, o usuário não precisa saber),
                    // finalmente mostramos os resultados.
                    showResultsPage();

                } catch (error) {
                    console.error("Erro ao enviar lead:", error);
                    // Mesmo se der erro, mostramos o resultado para não prejudicar o usuário.
                    showResultsPage(); 
                }
            });


            // (FUNÇÃO MODIFICADA) Agora esta função só *mostra* os resultados
            function showResultsPage() {
                leadCaptureSection.classList.add("hidden");
                resultsSection.classList.remove("hidden");

                // Preenche os resultados que já foram calculados
                document.getElementById("result-concept").textContent = finalConcept.level;
                document.getElementById("result-text").textContent = finalConcept.text;

                const worstPillar1 = finalPillarArray[0];
                const worstPillar2 = finalPillarArray[1];

                const attentionList = document.getElementById("attention-points");
                attentionList.innerHTML = `
                    <li>${worstPillar1.attentionText}</li>
                    <li>${worstPillar2.attentionText}</li>
                `;
            }

            // Inicia o Quiz
            renderQuestion(currentQuestionIndex);
        });
    </script>

</body>
</html>
